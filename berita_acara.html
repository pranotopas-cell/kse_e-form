<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KSE - Berita Acara Oper Muatan</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <style>
        :root { --kse-primary: #064e3b; --kse-dark: #022c22; }
        body { background-color: #f1f5f9; font-family: 'Arial', sans-serif; font-size: 11px; color: #334155; }
        
        .control-nav { background: #fff; border-bottom: 2px solid #e2e8f0; padding: 12px 24px; position: sticky; top: 0; z-index: 1000; }
        .input-sidebar { background: #fff; height: calc(100vh - 65px); overflow-y: auto; padding: 20px; border-right: 1px solid #e2e8f0; }
        
        /* Document Layout */
        .document-canvas { 
            background: white; width: 210mm; min-height: 297mm; 
            margin: 20px auto; padding: 15mm 20mm; position: relative;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); color: #000;
        }

        .header-section { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; border-bottom: 3px double #000; padding-bottom: 10px; }
        .logo-img { height: 55px; width: auto; }
        
        .ba-title { text-align: center; margin-bottom: 20px; }
        .ba-title h5 { font-weight: 900; text-decoration: underline; margin-bottom: 2px; font-size: 15px; color: #000; }
        .ba-title span { font-weight: 700; font-size: 11px; }

        .section-title { background: #f8fafc; padding: 5px 12px; font-weight: 800; margin: 15px 0 8px 0; border-left: 5px solid var(--kse-primary); border-bottom: 1px solid #e2e8f0; text-transform: uppercase; letter-spacing: 0.5px; }
        
        .data-grid { display: grid; grid-template-columns: 1fr; gap: 2px; margin-left: 15px; }
        .data-row { display: flex; align-items: baseline; margin-bottom: 2px; }
        .data-label { width: 180px; position: relative; font-weight: 500; }
        .data-label::after { content: ":"; position: absolute; right: 15px; }
        .data-value { font-weight: 600; flex: 1; }

        .signature-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 40px; text-align: center; }
        .sig-box { height: 130px; display: flex; flex-direction: column; justify-content: space-between; }
        .sig-box span { font-weight: 700; }
        .sig-name { font-weight: 900; text-decoration: underline; text-transform: uppercase; }

        .footer-kse { position: absolute; bottom: 10mm; width: calc(100% - 40mm); border-top: 1px solid #000; padding-top: 10px; }

        .form-label-custom { font-size: 10px; font-weight: 800; color: #475569; margin-top: 10px; display: block; text-transform: uppercase; }

        @media print {
            .control-nav, .input-sidebar { display: none !important; }
            body { background: white; padding: 0; }
            .document-canvas { margin: 0; box-shadow: none; width: 210mm; padding: 15mm 20mm !important; }
        }
    </style>
</head>
<body>

<div class="control-nav d-flex justify-content-between align-items-center">
    <div class="d-flex align-items-center gap-3">
        <img src="https://via.placeholder.com/100x30?text=KSE+LOGISTICS" style="height: 25px;">
        <h6 class="mb-0 fw-bold d-none d-md-block">E-BAOM GENERATOR</h6>
    </div>
    <div class="d-flex gap-2">
        <button class="btn btn-outline-dark btn-sm fw-bold" onclick="window.print()"><i class="bi bi-printer"></i> PRINT</button>
        <button class="btn btn-primary btn-sm fw-bold px-4" onclick="downloadPDF()"><i class="bi bi-file-pdf"></i> SIMPAN PDF</button>
    </div>
</div>

<div class="container-fluid">
    <div class="row">
        <div class="col-lg-3 input-sidebar shadow-sm">
            <div class="alert alert-dark py-2 mb-3"><i class="bi bi-info-circle me-2"></i><b>DATA DOKUMEN</b></div>
            
            <label class="form-label-custom">Nomor & Tanggal</label>
            <input type="text" id="in_no" class="form-control form-control-sm mb-2" placeholder="Nomor BA" oninput="updateView()">
            <input type="text" id="in_hari" class="form-control form-control-sm mb-2" placeholder="Hari (Senin, dsb)" oninput="updateView()">
            <input type="text" id="in_tgl_lengkap" class="form-control form-control-sm mb-2" placeholder="Tanggal Lengkap" oninput="updateView()">

            <label class="form-label-custom text-success">Sumber (Penyerah)</label>
            <input type="text" id="s_nopol" class="form-control form-control-sm mb-1" placeholder="Nopol Armada" oninput="updateView()">
            <input type="text" id="s_pt" class="form-control form-control-sm mb-1" placeholder="Nama Perusahaan" oninput="updateView()">
            <input type="text" id="s_segel_a" class="form-control form-control-sm mb-1" placeholder="Segel Atas" oninput="updateView()">
            <input type="text" id="s_segel_b" class="form-control form-control-sm mb-1" placeholder="Segel Bawah" oninput="updateView()">
            <input type="number" id="s_qty" class="form-control form-control-sm mb-1" placeholder="Quantity (Liter)" oninput="updateView()">
            <input type="text" id="s_tc" class="form-control form-control-sm mb-1" placeholder="TC Bongkar" oninput="updateView()">
            <input type="text" id="s_sopir" class="form-control form-control-sm mb-1" placeholder="Nama Sopir" oninput="updateView()">

            <label class="form-label-custom text-danger">Tujuan (Penerima)</label>
            <input type="text" id="t_nopol" class="form-control form-control-sm mb-1" placeholder="Nopol Armada" oninput="updateView()">
            <input type="text" id="t_pt" class="form-control form-control-sm mb-1" placeholder="Nama Perusahaan" oninput="updateView()">
            <input type="number" id="t_qty" class="form-control form-control-sm mb-1" placeholder="Quantity (Liter)" oninput="updateView()">
            <input type="text" id="t_tc" class="form-control form-control-sm mb-1" placeholder="TC Muat" oninput="updateView()">
            <input type="text" id="t_sopir" class="form-control form-control-sm mb-1" placeholder="Nama Sopir" oninput="updateView()">

            <label class="form-label-custom">Otorisasi Tanda Tangan</label>
            <input type="text" id="in_sig_operasional" class="form-control form-control-sm mb-1" placeholder="Nama Operasional" oninput="updateView()">
            
            <label class="form-label-custom">Catatan Tambahan</label>
            <textarea id="in_note" class="form-control form-control-sm" rows="2" placeholder="Catatan..." oninput="updateView()"></textarea>
        </div>

        <div class="col-lg-9 p-0" id="pdf-area">
            <div class="document-canvas">
                <div class="header-section">
                    <img src="header1.png" class="logo-img" onerror="this.src='https://via.placeholder.com/200x60/064e3b/FFFFFF?text=PT.+KSE'">
                    <div class="text-end">
                        <small class="fw-bold">Form: KSE-BAOM-2026</small><br>
                        <small>Original Document</small>
                    </div>
                </div>

                <div class="ba-title">
                    <h5>BERITA ACARA OPER MUATAN BAHAN BAKAR MINYAK (BBM)</h5>
                    <span>NOMOR: <span id="out_no"></span></span>
                </div>

                <p style="line-height: 1.6;">Pada hari ini <b id="out_hari"></b>, <span id="out_tgl_lengkap"></span>, bertempat di <b>Pangkalan Bun</b>, telah dilaksanakan kegiatan pemindahan (oper) muatan Bahan Bakar Minyak (BBM) Non-Subsidi dengan rincian data sebagai berikut:</p>

                <div class="section-title">I. DATA UNIT PENYERAH (SUMBER)</div>
                <div class="data-grid">
                    <div class="data-row"><div class="data-label">Nomor Polisi</div><div class="data-value" id="os_nopol"></div></div>
                    <div class="data-row"><div class="data-label">Nama Perusahaan</div><div class="data-value" id="os_pt"></div></div>
                    <div class="data-row"><div class="data-label">Nomor Segel (Atas/Bawah)</div><div class="data-value"><span id="os_segel_a"></span> / <span id="os_segel_b"></span></div></div>
                    <div class="data-row"><div class="data-label">Volume Muatan</div><div class="data-value" id="os_qty"></div></div>
                    <div class="data-row"><div class="data-label">Tera Control (TC) Bongkar</div><div class="data-value" id="os_tc"></div></div>
                    <div class="data-row"><div class="data-label">Nama Pengemudi</div><div class="data-value" id="os_sopir"></div></div>
                </div>

                <div class="section-title">II. DATA UNIT PENERIMA (TUJUAN)</div>
                <div class="data-grid">
                    <div class="data-row"><div class="data-label">Nomor Polisi</div><div class="data-value" id="ot_nopol"></div></div>
                    <div class="data-row"><div class="data-label">Nama Perusahaan</div><div class="data-value" id="ot_pt"></div></div>
                    <div class="data-row"><div class="data-label">Volume Diterima</div><div class="data-value" id="ot_qty"></div></div>
                    <div class="data-row"><div class="data-label">Tera Control (TC) Muat</div><div class="data-value" id="ot_tc"></div></div>
                    <div class="data-row"><div class="data-label">Nama Pengemudi</div><div class="data-value" id="ot_sopir"></div></div>
                </div>

                <p class="mt-4" style="text-align: justify; line-height: 1.5;">
                    Demikian Berita Acara ini dibuat dengan sebenar-benarnya untuk digunakan sebagai dokumen pendukung operasional, bukti serah terima fisik muatan, serta dasar laporan administrasi bagi pihak-pihak terkait.
                </p>

                <div class="signature-grid">
                    <div class="sig-box">
                        <span>Penyerah,</span>
                        <div class="mt-auto sig-name" id="os_sopir_sig">......................</div>
                        <div>Sopir Penyerah</div>
                    </div>
                    <div class="sig-box">
                        <span>Penerima,</span>
                        <div class="mt-auto sig-name" id="ot_sopir_sig">......................</div>
                        <div>Sopir Penerima</div>
                    </div>
                    <div class="sig-box">
                        <span>Pangkalan Bun, <span id="out_tgl_footer"></span><br>Mengetahui,</span>
                        <div class="mt-auto sig-name" id="out_operasional_sig">......................</div>
                        <div>Operasional KSE</div>
                    </div>
                </div>

                <div class="mt-4 p-2" style="border: 1px dashed #ccc; border-radius: 5px;">
                    <small class="fw-bold d-block">Catatan (Note):</small>
                    <span id="out_note"></span>
                </div>

                <div class="footer-kse">
                    <div class="d-flex justify-content-between align-items-end">
                        <div style="font-size: 8px; color: #64748b;">
                            <b>KSE LOGISTICS SMART SYSTEM</b> | Digital BA-OM Format<br>
                            ID: <span id="doc_id"></span> | Terverifikasi Sistem Internal
                        </div>
                        <div class="text-end">
                            <b style="font-size: 11px; color: var(--kse-primary);">PT. KHATULISTIWA SINAR ENERGI</b><br>
                            <span style="font-size: 8px; color: #475569;">Pangkalan Bun, Kotawaringin Barat, Kalimantan Tengah</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script>
    function updateView() {
        const mapping = {
            'in_no': 'out_no', 
            'in_hari': 'out_hari', 
            'in_tgl_lengkap': 'out_tgl_lengkap', 
            'in_note': 'out_note',
            's_nopol': 'os_nopol', 
            's_pt': 'os_pt', 
            's_segel_a': 'os_segel_a', 
            's_segel_b': 'os_segel_b',
            's_tc': 'os_tc', 
            's_sopir': 'os_sopir', 
            't_nopol': 'ot_nopol', 
            't_pt': 'ot_pt', 
            't_tc': 'ot_tc', 
            't_sopir': 'ot_sopir',
            'in_sig_operasional': 'out_operasional_sig'
        };

        for (let id in mapping) {
            let val = document.getElementById(id).value;
            document.getElementById(mapping[id]).innerText = val ? val : "......................";
        }

        // Mirroring Names for Signature Boxes
        document.getElementById('os_sopir_sig').innerText = document.getElementById('s_sopir').value || "......................";
        document.getElementById('ot_sopir_sig').innerText = document.getElementById('t_sopir').value || "......................";

        // Handle Qty formatting
        const sqty = document.getElementById('s_qty').value;
        document.getElementById('os_qty').innerText = sqty ? parseFloat(sqty).toLocaleString('id-ID') + " Liter" : "...................... Liter";
        
        const tqty = document.getElementById('t_qty').value;
        document.getElementById('ot_qty').innerText = tqty ? parseFloat(tqty).toLocaleString('id-ID') + " Liter" : "...................... Liter";
        
        // Auto Date for Footer
        const tglFull = document.getElementById('in_tgl_lengkap').value;
        if(tglFull && tglFull.includes("202")) {
            // Sederhanakan tanggal jika panjang
            document.getElementById('out_tgl_footer').innerText = tglFull.replace("tanggal ", "").replace("bulan ", "").replace("tahun ", "");
        } else {
            document.getElementById('out_tgl_footer').innerText = "23 Januari 2026";
        }
    }

    function downloadPDF() {
        const element = document.getElementById('pdf-area');
        const filename = 'BAOM_' + (document.getElementById('s_nopol').value || 'DOC') + '_' + Date.now() + '.pdf';
        const opt = {
            margin: 0,
            filename: filename,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 3, useCORS: true },
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
        };
        html2pdf().set(opt).from(element).save();
    }

    window.onload = function() {
        // Set Default Values
        document.getElementById('in_no').value = "012 / BA-OM / KSE / I / 2026";
        document.getElementById('in_hari').value = "Jumat";
        document.getElementById('in_tgl_lengkap').value = "tanggal 23 bulan Januari tahun 2026";
        document.getElementById('s_nopol').value = "KH 8812 GI";
        document.getElementById('s_pt').value = "PT. KHATULISTIWA SINAR ENERGI";
        document.getElementById('s_qty').value = "5000";
        document.getElementById('s_sopir').value = "SUPRANOTO";
        document.getElementById('t_nopol').value = "KH 1123 GK";
        document.getElementById('t_pt').value = "PT. SINARINDO SUKSES SELALU";
        document.getElementById('t_qty').value = "5000";
        document.getElementById('in_sig_operasional').value = "DANI RAMDHANI";
        document.getElementById('doc_id').innerText = "KSE-" + Math.random().toString(36).substr(2, 9).toUpperCase();
        updateView();
    };
</script>
</body>
</html>
